<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YUN YANG é›²æ¼¾ï½œ2026 éˆé­‚å¹´åº¦å°èˆª</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;500;700&display=swap');
        :root { --é›²æ¼¾é‡‘: #d4b483; --èƒŒæ™¯é»‘: #0d0c0b; --å¡ç‰‡é»‘: #1c1916; --ç·šæ¢é‡‘: rgba(212, 180, 131, 0.3); }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        body { background: var(--èƒŒæ™¯é»‘); font-family: 'Noto Serif TC', serif; color: #e0e0e0; margin: 0; line-height: 1.8; -webkit-text-size-adjust: 100%; overflow-x: hidden; }
        .å…‰æšˆ { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 50% 5%, #25211d 0%, var(--èƒŒæ™¯é»‘) 100%); z-index: -1; }
        .å®¹å™¨ { max-width: 500px; margin: 0 auto; padding: 20px 20px 40px 20px; box-sizing: border-box; }
        .å“ç‰ŒLogo { width: 150px; height: auto; margin: 0 auto 10px auto; display: block; filter: drop-shadow(0 0 10px rgba(212, 180, 131, 0.3)); }
        h1 { text-align: center; color: var(--é›²æ¼¾é‡‘); letter-spacing: 5px; font-weight: 300; margin-bottom: 20px; font-size: 22px; }
        .å¼•å°æ–‡ { text-align: center; font-size: 14px; color: #aaa; margin-bottom: 30px; letter-spacing: 1px; }
        .å•Ÿå‹•å€ { text-align: center; margin-bottom: 30px; padding: 30px 20px; border: 1px solid var(--ç·šæ¢é‡‘); background: rgba(0,0,0,0.4); }
        .è¼¸å…¥çµ„ { margin-bottom: 25px; text-align: left; }
        .æ¨™ç±¤ { display: block; color: var(--é›²æ¼¾é‡‘); font-size: 12px; letter-spacing: 1px; margin-bottom: 8px; font-weight: 500; }
        input { background: none; border: none; border-bottom: 1px solid var(--ç·šæ¢é‡‘); font-size: 16px; width: 100%; text-align: left; color: #fff; outline: none; padding: 8px 0; border-radius: 0; transition: 0.3s; }
        input:focus { border-bottom: 1px solid var(--é›²æ¼¾é‡‘); }
        .ä¸»æŒ‰éˆ•, .åº•éƒ¨æŒ‰éˆ• { cursor: pointer; transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1); border: none; }
        .ä¸»æŒ‰éˆ• { background: var(--é›²æ¼¾é‡‘); color: #2a2218; padding: 18px; font-size: 16px; font-weight: 700; width: 100%; letter-spacing: 3px; margin-top: 10px; }
        .ä¸»æŒ‰éˆ•:active, .åº•éƒ¨æŒ‰éˆ•:active { transform: scale(0.97); opacity: 0.8; }
        .ç³»çµ±èªªæ˜ { font-size: 12px; color: #888; text-align: justify; padding: 25px; background: rgba(255,255,255,0.02); border: 1px solid rgba(212,180,131,0.1); border-radius: 2px; margin-bottom: 40px; }
        .ç³»çµ±èªªæ˜ b { color: var(--é›²æ¼¾é‡‘); font-weight: 700; }
        #å ±å‘Šå€åŸŸ { display: none; }
        .ç« ç¯€å¡ç‰‡ { background: var(--å¡ç‰‡é»‘); border: 1px solid var(--ç·šæ¢é‡‘); padding: 30px 20px; margin-bottom: 30px; animation: slideUp 0.8s ease-out; }
        .ç« ç¯€æ¨™é¡Œ { color: var(--é›²æ¼¾é‡‘); font-size: 18px; border-bottom: 1px solid var(--ç·šæ¢é‡‘); padding-bottom: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; }
        .è§£ææœ¬æ–‡ { font-size: 14px; color: #ccc; text-align: justify; line-height: 1.8; margin-bottom: 15px; }
        .é‡é» { color: var(--é›²æ¼¾é‡‘); font-weight: 700; border-bottom: 1.5px solid var(--é›²æ¼¾é‡‘); padding: 0 2px; }
        .å¡”å±¤ { display: flex; margin-bottom: 15px; justify-content: center; }
        .å¡”é» { width: 42px; height: 42px; line-height: 42px; text-align: center; border: 1px solid var(--ç·šæ¢é‡‘); border-radius: 50%; margin: 0 8px; font-size: 18px; color: var(--é›²æ¼¾é‡‘); }
        .æ ¸å¿ƒé» { background: var(--é›²æ¼¾é‡‘); color: #2a2218; font-weight: bold; border: none; box-shadow: 0 0 15px rgba(212, 180, 131, 0.5); }
        .æŒ‡æ¨™å€ { margin: 25px 0; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 20px; }
        .æ•¸æ“šå€¼ { color: var(--é›²æ¼¾é‡‘); font-weight: bold; font-size: 24px; float: right; margin-top: -5px; }
        .é€²åº¦æ¢å¤– { height: 4px; background: rgba(255,255,255,0.1); margin: 12px 0; overflow: hidden; }
        .é€²åº¦æ¢å…§ { height: 100%; background: var(--é›²æ¼¾é‡‘); transition: width 1.2s ease-out; }
        .æ°´æ™¶è¡¨æ ¼ { width: 100%; border-collapse: collapse; margin-top: 15px; background: rgba(255,255,255,0.02); }
        .æ°´æ™¶è¡¨æ ¼ td { padding: 15px 10px; border: 1px solid rgba(212, 180, 131, 0.2); font-size: 13px; vertical-align: top; }
        .è¡¨æ ¼æ¨™é¡Œ { color: var(--é›²æ¼¾é‡‘); font-weight: bold; width: 95px; background: rgba(212, 180, 131, 0.05); }
        .é«˜éšç‰† { background: rgba(212, 180, 131, 0.05); padding: 25px; border: 1px dashed var(--é›²æ¼¾é‡‘); margin-top: 20px; text-align: left; }
        .é«˜éšç‰† ul { font-size: 12px; color: #aaa; padding-left: 15px; line-height: 2.2; margin-top: 10px; }
        .åº•éƒ¨æŒ‰éˆ• { text-decoration: none; text-align: center; padding: 16px; border: 1px solid var(--ç·šæ¢é‡‘); color: var(--é›²æ¼¾é‡‘); font-size: 14px; display: block; margin-top: 15px; letter-spacing: 2px; }
        .å¼·èª¿ { background: var(--é›²æ¼¾é‡‘); color: #2a2218; border: none; font-weight: bold; }
        .æŠ˜æŠµæ–¹æ¡ˆ { border: 1px solid var(--é›²æ¼¾é‡‘); color: var(--é›²æ¼¾é‡‘); padding: 10px; text-align: center; font-size: 13px; margin: 15px 0; font-weight: 700; background: rgba(212, 180, 131, 0.1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
<div class="å…‰æšˆ"></div>
<div class="å®¹å™¨">
    <img src="logo.png" alt="YUN YANG Logo" class="å“ç‰ŒLogo" onerror="this.style.display='none'">
    <h1>YUN YANG é›²æ¼¾ï½œ2026 å¹´åº¦å°èˆª</h1>
    <div id="inputSection">
        <div class="å¼•å°æ–‡">ã€Œç•¶éˆé­‚æœ¬æºå°é½Šæµå¹´é »ç‡ï¼Œé¡¯åŒ–å°‡å¦‚ç´„è€Œè‡³ã€‚ã€</div>
        <div class="å•Ÿå‹•å€">
            <div class="è¼¸å…¥çµ„"><span class="æ¨™ç±¤">æ‚¨çš„å°Šç¨±</span><input type="text" id="yy_name"></div>
            <div class="è¼¸å…¥çµ„"><span class="æ¨™ç±¤">ä¿¡ç®±ï¼ˆå‚³é€å®Œæ•´è§£æå ±å‘Šç”¨ï¼‰</span><input type="email" id="yy_email"></div>
            <div class="è¼¸å…¥çµ„"><span class="æ¨™ç±¤">LINE ID (è«®è©¢å°æ¥ç”¨ï¼‰</span><input type="text" id="yy_line"></div>
            <div class="è¼¸å…¥çµ„"><span class="æ¨™ç±¤">è¥¿å…ƒç”Ÿæ—¥ 8 ç¢¼ (YYYYMMDD)</span><input type="tel" id="yy_bday" maxlength="8" placeholder="ä¾‹å¦‚ 19880101"></div>
            <button id="calcBtn" class="ä¸»æŒ‰éˆ•" onclick="startCalc()">å•Ÿå‹• 2026 é›²æ¼¾æ·±åº¦ç²¾ç®—</button>
        </div>
        <div class="ç³»çµ±èªªæ˜">
            <b>ç‚ºä»€éº¼é¸æ“‡é›²æ¼¾ï¼Ÿ</b><br>
            æˆ‘å€‘æ˜¯å¸‚å ´é¦–å®¶å®Œç¾èåˆ<b>ã€è¥¿æ–¹éˆæ•¸ã€‘</b>èˆ‡æ±æ–¹æ•¸è¡“ä¹‹å·”<b>ã€æ²³åœ–æ´›æ›¸ã€‘</b>çš„èƒ½é‡è¨ºæ–·å“ç‰Œã€‚ç”Ÿå‘½éˆæ•¸å®šç¾©è¡Œç‚ºæ€§æ ¼ï¼Œæ²³åœ–æ­ç¤ºéˆé­‚æœ¬æºã€‚é€éé›²æ¼¾ç¨å®¶ <b>60-20-20 æ¼”ç®—æ³•</b>ï¼Œæˆ‘å€‘æ·±å…¥æ¢è¨å…ˆå¤©æœ¬æºèˆ‡å¾Œå¤©è¡Œç‚ºåœ¨ 2026 ä¸™åˆç«å¹´ç’°å¢ƒä¸‹çš„å…±æŒ¯èˆ‡æ‘©æ“¦ã€‚
        </div>
    </div>
    <div id="å ±å‘Šå€åŸŸ"></div>
</div>

<script>
    // --- 1. è‡ªå‹•è®€å–èˆ‡å„²å­˜è¨˜æ†¶åŠŸèƒ½ ---
    window.onload = function() {
        if(localStorage.getItem('yy_name')) document.getElementById('yy_name').value = localStorage.getItem('yy_name');
        if(localStorage.getItem('yy_email')) document.getElementById('yy_email').value = localStorage.getItem('yy_email');
        if(localStorage.getItem('yy_line')) document.getElementById('yy_line').value = localStorage.getItem('yy_line');
        if(localStorage.getItem('yy_bday')) document.getElementById('yy_bday').value = localStorage.getItem('yy_bday');
    };

    // --- 2. æ•¸æ“šå­—å…¸ (ç„¡çœç•¥) ---
    const yyDict = {
        soul: { 1: "ã€æ°´ä¹‹æœ¬æºã€‘æ²ˆç©©åŒ…å®¹ï¼Œæ™ºæ…§å¦‚æ·±æ°´é•·æµã€‚", 2: "ã€ç«ä¹‹éˆæ€§ã€‘æ•éŠ³æº«æš–ï¼Œç‡­ç«èˆ¬çš„æ„ŸæŸ“åŠ›ã€‚", 3: "ã€æœ¨ä¹‹ç”Ÿé•·ã€‘ç„¡é™å‘ä¸Šï¼Œç”Ÿç”Ÿä¸æ¯çš„åŠ›é‡ã€‚", 4: "ã€é‡‘ä¹‹æ”¶å‰²ã€‘æœæ–·èšç„¦ï¼Œå“è¶Šçš„è®Šç¾æ‰è¯ã€‚", 5: "ã€åœŸä¹‹æ‰¿è¼‰ã€‘åšå¯¦å¤§åœ°ï¼Œæœ€å¯é çš„å¾Œç›¾ã€‚", 6: "ã€æ°´ä¹‹æ™ºæ…§ã€‘éˆæ´»æŸ”éŸŒï¼Œå„ªé›…åœ°åŒ–è§£é˜»ç¤™ã€‚", 7: "ã€ç«ä¹‹å…‰èŠ’ã€‘ç”Ÿå‘½æ—ºç››ï¼Œå¤©ç”Ÿçš„èƒ½é‡å¼•å°è€…ã€‚", 8: "ã€æœ¨ä¹‹æ ¼å±€ã€‘æ·±è¬€å¤§å™¨ï¼Œå…·å‚™é ˜è¢–çš„æ“”ç•¶ã€‚", 9: "ã€é‡‘ä¹‹åœ“æ»¿ã€‘èƒ½é‡å¼·å¤§ï¼Œé¡¯åŒ–ç†æƒ³çš„é »ç‡ã€‚" },
        personalYear: { 1: "ã€é–‹å‰µå•Ÿå‹•ã€‘è¡Œç‚ºé »ç‡æŒ‡å‘å…¨æ–°é–‹å§‹ã€‚é©åˆç¨ç«‹æˆé•·èˆ‡æ’­ç¨®ã€‚", 2: "ã€åˆä½œå…±æŒ¯ã€‘è¶¨æ–¼ç´°è†©å¹³è¡¡ã€‚é©åˆåœ¨é—œä¿‚ä¸­å°‹æ±‚å…±è­˜èˆ‡ç²å–è³‡æºã€‚", 3: "ã€è¡¨é”æ“´å¼µã€‘éˆæ„Ÿçˆ†ç™¼ä¹‹å¹´ã€‚é©åˆç¤¾äº¤æ“´å±•èˆ‡å‰µæ„æ‰è¯é¡¯åŒ–ã€‚", 4: "ã€ç©©å›ºå»ºæ§‹ã€‘å‹™å¯¦ç´®æ ¹ã€‚é‡é»åœ¨æ–¼å„ªåŒ–æµç¨‹ï¼Œç‚ºæœªä¾†åå¹´å¥ åŸºã€‚", 5: "ã€è®Šé©è½‰åŒ–ã€‘è¡Œç‚ºè¿½æ±‚è‡ªç”±ã€‚é©æ‡‰åŠ›å¼·ï¼Œé©åˆè®Šå‹•ä¸­å°‹æ±‚çªåœã€‚", 6: "ã€è²¬ä»»å¥‰ç»ã€‘é—œæ³¨å’Œè«§èˆ‡ä¿¡ä»»ã€‚é©åˆå»ºç«‹æ·±å±¤é€£çµç²å¾—æˆå°±ã€‚", 7: "ã€å…§çœæ¢ç´¢ã€‘è½‰å‘å…§åœ¨ä¿®å¾©ã€‚é©åˆå­¸ç¿’å¾©ç›¤ï¼Œå¾éœé»˜ä¸­å¾—æ´è¦‹ã€‚", 8: "ã€æ¬Šå¨é¡¯åŒ–ã€‘å‹•èƒ½æœ€å¼·ä¹‹å¹´ã€‚å¼·å¤§é¡¯åŒ–åŠ›ï¼Œæ˜¯æˆæœè®Šç¾é—œéµå¹´ã€‚", 9: "ã€æ²ˆæ¾±åœ“æ»¿ã€‘é€²å…¥çµæ¡ˆé€±æœŸã€‚é©åˆæ¸…ç†èƒ½é‡ï¼Œæ²ˆæ¾±åº•æ°£è¿æ¥æ–°è¼ªè¿´ã€‚" },
        conflict: { 1: "è¡Œç‚ºæ¨™æº–èˆ‡æœ¬æºæŸ”è»Ÿæ•´åˆä¸­ã€‚è¨˜å¾—çµ¦äºˆéˆé­‚ä¿®å¾©æ™‚é–“ã€‚", 2: "æ„ŸçŸ¥èˆ‡ç›´è¦ºå…±èˆã€‚å°‡æ•æ„Ÿè½‰åŒ–ç‚ºå„ªé›…å‰µé€ åŠ›ã€‚", 3: "è¡Œå‹•é»ç‡ƒæ ¼å±€ã€‚é€²å…¥å¿«é€Ÿæˆé•·æœŸï¼Œæ³¨æ„é©åº¦ç´®æ ¹ã€‚", 4: "é¡˜æ™¯å°‹æ±‚è½å¯¦ã€‚ç«å¹´è³¦äºˆå‹‡æ°£ï¼Œå¹«åŠ©æ‚¨èšç„¦æ ¸å¿ƒç›®æ¨™ã€‚", 5: "å…§å¤–çš†åœŸï¼Œæ€§æ ¼æ¥µç©©ã€‚ä¿æŒæµå‹•é–‹æ”¾ï¼Œè®“å¤§åœ°å……æ»¡ç”Ÿæ©Ÿã€‚", 6: "ç§©åºèˆ‡æ™ºæ…§èåˆã€‚ä¿æŒå½ˆæ€§èƒ½å°‡æ©Ÿé‡è½‰åŒ–ç‚ºè±åšæˆæœã€‚", 7: "ç·´ç¿’å±•ç¾çœŸå¯¦è‡ªæˆ‘ï¼Œç‚ºè‡ªå·±é–ƒè€€ï¼Œå…¨ä¸–ç•Œéƒ½æœƒç‚ºæ‚¨è®“è·¯ã€‚", 8: "å¼·å¤§é¡¯åŒ–ä¾†è‡ªæ ¼å±€ã€‚ç¶­æŒç©©å¥æ­¥èª¿ï¼Œé˜²ç¯„èƒ½é‡éç†±ã€‚", 9: "è¡Œç‚ºèˆ‡æœ¬æºå·²é”åœ“æ»¿ã€‚èšç„¦å¯¦è³ªæˆå°±ï¼ŒåŒ–ç‚ºéˆé­‚è³‡ç”¢ã€‚" },
        dims: {
            w: { h: "äº‹æ¥­æ”¶å‰²åŠ›å¼·ã€‚2026 é©åˆç²¾æº–é¡¯åŒ–ã€‚", l: "è™•æ–¼é‡æ•´æœŸã€‚å»ºè­°å…ˆç©©å›ºæ ¸å¿ƒåŸºåº•ã€‚" },
            h: { h: "èº«å¿ƒèª¿ç¯€å„ªç•°ã€‚å³ä¾¿åœ¨é«˜å£“ä»èƒ½ç¶­æŒå¯§éœã€‚", l: "èƒ½é‡æ­£é«˜åº¦é‹è½‰ã€‚æé†’æ‚¨éœ€å¢åŠ æ·±åº¦ä¿®å¾©ã€‚" },
            e: { h: "ç¤¾äº¤ç£å ´å¼·å¤§ã€‚è®“å’Œè«§é—œä¿‚æˆç‚ºå¹´åº¦åŠ©åŠ›ã€‚", l: "æƒ…æ„Ÿç£å ´è¶¨æ–¼å…§æ–‚ã€‚é©åˆå¾å¹³éœä¸­æ‰¾å›é€£çµã€‚" },
            f: { h: "åœ°åŸºç©©å¥å…·è¼‰ç‰©åŠ›ã€‚å®¶åº­æ˜¯æ‚¨çš„é¿é¢¨æ¸¯ã€‚", l: "å°‹æ±‚ç©©å®šé»ã€‚å»ºè­°è£œå¼·åœŸå…ƒç´ æå‡å®‰å…¨æ„Ÿã€‚" },
            wi: { h: "èªçŸ¥æ ¼å±€å±•ç¾æ™ºæ…§ã€‚å»ºè­°å°‡éˆæ„Ÿè½åœ°ï¼Œå¯¦ç¾é¡¯åŒ–ã€‚", l: "æ€ç¶­å°‹æ±‚çªç ´ã€‚æ‰“ç ´æ¡†æ¶è®“é¡˜æ™¯ç²æ–°å‹•åŠ›ã€‚" }
        },
        crystals: {
            wood: { main: "ç¶ å¹½éˆåƒå±¤å±± / æ™¯è§€å¹½éˆ", intent: "ã€éˆæ ¹åº§å±±ã€‘ï¼šå±¤æ¬¡å±±å·’è±¡å¾µã€Œç¯€ç¯€é«˜å‡ã€èˆ‡ã€Œè²´äººé å±±ã€ã€‚", support: "æ­é… ç¶ å¹½éˆ / è‘¡è„çŸ³", nums: [3, 8] },
            fire: { main: "ç´…å¹½éˆå…±ç”Ÿç´…å…”æ¯› / æ™¶ä¸­æ™¶", intent: "ã€çƒˆç„°éˆå¢ƒã€‘ï¼šå…±ç”Ÿç´…å…”æ¯›è±¡å¾µç«å¹´é¡¯åŒ–é€Ÿåº¦èˆ‡çˆ†ç™¼åŠ›ã€‚", support: "æ­é… ç´…è¶…ä¸ƒ / é‡‘è‰è“", nums: [2, 7] },
            earth: { main: "é»ƒå¹½éˆèšå¯¶ç›† / å¸¶æ™¯é‡‘è‰è“", intent: "ã€å¤§åœ°åšå¾·ã€‘ï¼šè±¡å¾µã€Œèšè²¡å…¥åº«ã€ï¼Œè®“ç«å¹´çš„ç†±èƒ½è½‰åŒ–ç‚ºå¯¦é«”è³‡ç”¢ã€‚", support: "æ­é… éˆ¦æ™¶ / é»ƒè™çœ¼", nums: [5] },
            metal: { main: "éˆ¦æ™¶é‡‘å­—å¡” / éˆ¦æ™¶å¸¶é‡‘å±±", intent: "ã€å‰›æ¯…å·”å³°ã€‘ï¼šè±¡å¾µæ¬ŠåŠ›ä¹‹å·”ï¼Œåœ¨å‹•ç›ªä¸­å®ˆä½è²¡å¯Œèˆ‡ç§©åºã€‚", support: "æ­é… é‡‘é‹çŸ³ / é»‘éŠ€éˆ¦", nums: [4, 9] },
            water: { main: "æ°´è†½æ°´æ™¶ / æ™¶ä¸­æ™¶ (æ°´æ™¯)", intent: "ã€æ™ºæ³‰éˆå‹•ã€‘ï¼šæ´»æ°´è±¡å¾µéˆé­‚æ¸…æ˜èˆ‡æµå‹•æ™ºæ…§ï¼Œåœ¨ç‡¥ç†±ä¸­å®ˆä½æ¸…æ˜ã€‚", support: "æ­é… æµ·ç´‹çŸ³ / é¦¬å³¶æœˆå…‰", nums: [1, 6] }
        }
    };

    function yyAdd(a, b) {
        let n1 = parseInt(a); let n2 = parseInt(b);
        if (n1 === 0 && n2 === 0) return 9;
        let s = n1 + n2;
        while (s > 9) { s = s.toString().split('').map(Number).reduce((x, y) => x + y, 0); }
        return s === 0 ? 9 : s;
    }

    function startCalc() {
        const nVal = document.getElementById('yy_name').value;
        const eVal = document.getElementById('yy_email').value;
        const lVal = document.getElementById('yy_line').value;
        const bday = document.getElementById('yy_bday').value;
        const btn = document.getElementById('calcBtn');

        if(!nVal || !eVal || !lVal || bday.length !== 8) { alert("è«‹å®Œæ•´å¡«å¯«è³‡è¨Šã€‚"); return; }

        // --- å„²å­˜è¨˜æ†¶ ---
        localStorage.setItem('yy_name', nVal);
        localStorage.setItem('yy_email', eVal);
        localStorage.setItem('yy_line', lVal);
        localStorage.setItem('yy_bday', bday);

        btn.disabled = true; btn.innerText = "æ•¸æ“šåŒæ­¥ä¸­...";

        const b = bday.split('').map(Number);
        const d1 = yyAdd(b[6], b[7]); const d2 = yyAdd(b[4], b[5]); const d3 = yyAdd(b[0], b[1]); 
        const d4 = (b[2] === 0 && b[3] === 0) ? 9 : yyAdd(b[2], b[3]);
        const m1 = yyAdd(d1, d2); const m2 = yyAdd(d3, d4);
        const peak = yyAdd(m1, m2); const pyr = [peak, m1, m2, d1, d2, d3, d4];
        const pYear = yyAdd(yyAdd(b[4], b[5]) + yyAdd(b[6], b[7]), 1);

        function gS(ts) {
            let p = 0; if (ts.includes(pyr[0])) p += 42; if (ts.includes(pyr[1])) p += 7; if (ts.includes(pyr[2])) p += 7;
            for(let i=3; i<=6; i++) { if(ts.includes(pyr[i])) p += 3.5; } return Math.min(99, Math.round(30 + p));
        }
        const sc = { w: gS([1,6,4,9]), h: gS([2,7,1,6]), e: gS([3,8,2,7]), f: gS([5,9]), wi: gS([4,9,3,8]) };
        let crs; for(let k in yyDict.crystals) { if(yyDict.crystals[k].nums.includes(peak)) crs = yyDict.crystals[k]; }
        const report = yyDict.soul[peak] + " " + yyDict.conflict[peak];

        // --- æ ¸å¿ƒï¼šèˆ‡ Make ç´«è‰²è®Šæ•¸å®Œå…¨å°æ‡‰çš„ç™¼é€åŒ… ---
        fetch("https://hook.eu1.make.com/lmzegbvtpptn2sk7qzxj4i3ukuq1wkqs", {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                name: nVal,
                email: eVal,
                birthday: bday,
                lineId: lVal,
                peakNum: peak,
                yearNum: pYear,
                element: yyDict.soul[peak].split('ã€‘')[0].replace('ã€', ''),
                L3_0: m1, L3_1: m2, L2_0: d1, L2_1: d2, L2_2: d3, L2_3: d4,
                report: report
            })
        }).then(() => console.log("é›²æ¼¾å¾Œå°åŒæ­¥æˆåŠŸ"));

        // --- æ¸²æŸ“ç•Œé¢ ---
        let html = `
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>ç¬¬ä¸€ç« ï¼š2026 å¹´åº¦èƒ½é‡å…¨æ™¯</span><span>P01</span></div>
                <div class="è§£ææœ¬æ–‡">2026 æ˜¯å…¨çƒæµå¹´<span class="é‡é»">ã€Œ1ã€è™Ÿé–‹å‰µå¹´</span>ï¼Œç’°å¢ƒæ˜¯<span class="é‡é»">ã€Œä¸™åˆç«å¹´ã€</span>ã€‚é›²æ¼¾å¼•å°æ‚¨åœ¨å¼·ç«ç£å ´ä¸­æ‰¾åˆ°å¹³è¡¡é»ã€‚</div>
            </div>
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>ç¬¬äºŒç« ï¼šå€‹äººæµå¹´é »ç‡å°ä½</span><span>P02</span></div>
                <div class="è§£ææœ¬æ–‡" style="text-align:center; color:var(--é›²æ¼¾é‡‘); font-weight:bold;">ã€ æ‚¨çš„ 2026 å€‹äººæµå¹´ç‚ºï¼š${pYear} ã€‘</div>
                <div class="è§£ææœ¬æ–‡"><span class="é‡é»">æµå¹´è¶¨å‹¢ï¼š</span>${yyDict.personalYear[pYear]}</div>
                <div class="è§£ææœ¬æ–‡" style="margin-top:15px; border-top:1px dashed var(--ç·šæ¢é‡‘); padding-top:15px;">ç•¶é€™è‚¡è¡Œç‚ºé »ç‡é‡åˆ°æ‚¨çš„<span class="é‡é»">${peak} è™Ÿæ ¸å¿ƒæœ¬æº</span>ï¼Œé¡¯åŒ–å°‡ç”¢ç”Ÿæ‘©æ“¦å…±æŒ¯ã€‚</div>
            </div>
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>ç¬¬ä¸‰ç« ï¼šéˆé­‚æœ¬æºæ•´åˆè¨ºæ–·</span><span>P03</span></div>
                <div class="å¡”å±¤"><div class="å¡”é» æ ¸å¿ƒé»">${peak}</div></div>
                <div class="å¡”å±¤"><div class="å¡”é»">${m1}</div><div class="å¡”é»">${m2}</div></div>
                <div class="å¡”å±¤" style="opacity:0.4"><div class="å¡”é»">${d1}</div><div class="å¡”é»">${d2}</div><div class="å¡”é»">${d3}</div><div class="å¡”é»">${d4}</div></div>
                <div class="è§£ææœ¬æ–‡" style="text-align:center; color:var(--é›²æ¼¾é‡‘); font-weight:bold; margin-top:20px;">ã€ éˆé­‚æœ¬æºç²¾ç®— ã€‘</div>
                <div class="è§£ææœ¬æ–‡"><span class="é‡é»">æœ¬æºç‰¹æ€§ï¼š</span>${yyDict.soul[peak]}</div>
                <div class="è§£ææœ¬æ–‡"><span class="é‡é»">æ•´åˆå¥‘æ©Ÿï¼š</span>${yyDict.conflict[peak]}</div>
            </div>
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>ç¬¬å››ç« ï¼šé¡¯åŒ–æŒ‡æ¨™å°èˆªï¼ˆäº”é‹ï¼‰</span><span>P04</span></div>
                <div class="æŒ‡æ¨™å€"><span>äº‹æ¥­è²¡å¯Œ</span><span class="æ•¸æ“šå€¼">${sc.w}%</span><div class="é€²åº¦æ¢å¤–"><div class="é€²åº¦æ¢å…§" style="width:${sc.w}%"></div></div><div class="è§£ææœ¬æ–‡">${sc.w > 70 ? yyDict.dims.w.h : yyDict.dims.w.l}</div></div>
                <div class="æŒ‡æ¨™å€"><span>èº«å¿ƒé »ç‡</span><span class="æ•¸æ“šå€¼">${sc.h}%</span><div class="é€²åº¦æ¢å¤–"><div class="é€²åº¦æ¢å…§" style="width:${sc.h}%"></div></div><div class="è§£ææœ¬æ–‡">${sc.h > 70 ? yyDict.dims.h.h : yyDict.dims.h.l}</div></div>
                <div class="æŒ‡æ¨™å€"><span>æƒ…æ„Ÿå…±æŒ¯</span><span class="æ•¸æ“šå€¼">${sc.e}%</span><div class="é€²åº¦æ¢å¤–"><div class="é€²åº¦æ¢å…§" style="width:${sc.e}%"></div></div><div class="è§£ææœ¬æ–‡">${sc.e > 70 ? yyDict.dims.e.h : yyDict.dims.e.l}</div></div>
                <div class="æŒ‡æ¨™å€"><span>å®¶åº­æ ¹åŸº</span><span class="æ•¸æ“šå€¼">${sc.f}%</span><div class="é€²åº¦æ¢å¤–"><div class="é€²åº¦æ¢å…§" style="width:${sc.f}%"></div></div><div class="è§£ææœ¬æ–‡">${sc.f > 70 ? yyDict.dims.f.h : yyDict.dims.f.l}</div></div>
                <div class="æŒ‡æ¨™å€"><span>ç²¾ç¥æ™ºæ…§</span><span class="æ•¸æ“šå€¼">${sc.wi}%</span><div class="é€²åº¦æ¢å¤–"><div class="é€²åº¦æ¢å…§" style="width:${sc.wi}%"></div></div><div class="è§£ææœ¬æ–‡">${sc.wi > 70 ? yyDict.dims.wi.h : yyDict.dims.wi.l}</div></div>
            </div>
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>ç¬¬äº”ç« ï¼šé›²æ¼¾ã€Œå±±æ°´å…¥å‘½ã€ç‰¹æ®Šç¤¦å®šåˆ¶</span><span>P05</span></div>
                <div class="è§£ææœ¬æ–‡">ç‰¹æ®Šç¤¦ä¹‹æ‰€ä»¥æ˜‚è²´ï¼Œæ˜¯å› ç‚ºå®ƒå€‘å…§å«å„„è¬å¹´å½¢æˆçš„ã€Œæ„å¢ƒã€ã€‚é›²æ¼¾ç¨å‰µ<b>ã€Œä¸€ä¸»ï¼ˆç‰¹æ®Šæ„å¢ƒç¤¦ï¼‰+ å¤šè¼”ï¼ˆé«˜ç«¯èƒ½é‡çŸ³ï¼‰ã€</b>å®šåˆ¶é‚è¼¯ã€‚</div>
                <table class="æ°´æ™¶è¡¨æ ¼">
                    <tr><td class="è¡¨æ ¼æ¨™é¡Œ">æ„å¢ƒä¸»çŸ³</td><td>${crs.main}</td></tr>
                    <tr><td class="è¡¨æ ¼æ¨™é¡Œ">æ„å¢ƒè§£é‡‹</td><td>${crs.intent}</td></tr>
                    <tr><td class="è¡¨æ ¼æ¨™é¡Œ">é«˜ç«¯é…çŸ³</td><td>${crs.support}</td></tr>
                </table>
            </div>
            <div class="ç« ç¯€å¡ç‰‡">
                <div class="ç« ç¯€æ¨™é¡Œ"><span>å¹´åº¦çµ‚æ¥µæˆ°ç•¥è§£ç¢¼</span><span>VIP</span></div>
                <div class="é«˜éšç‰†">
                    <div style="color:var(--é›²æ¼¾é‡‘); font-weight:bold; margin-bottom:15px; font-size:16px; text-align:center;">âœ¦ 2026 éˆé­‚å¹´åº¦å°èˆªå…¨æ›¸ âœ¦</div>
                    <p style="font-size:13px; color:#eee;">è§£é– NT$ 600 é«˜éšç‰ˆï¼Œç²å¾— 30 é æ·±åº¦å°ä½å ±å‘Šï¼š</p>
                    <ul style="font-size:12px; color:#aaa; padding-left:15px; margin-bottom:15px;">
                        <li><b>å…¨å¹´åº¦æ¯æœˆèƒ½é‡å°èˆª</b>ï¼šæ¨™è¨»æ¯æœˆé¡¯åŒ–é«˜å³°ã€‚</li>
                        <li><b>æ²³åœ–å…ˆå¤©æœ¬æºæ¯”ä¾‹åˆ†æ</b>ï¼šæ‹†è§£èƒ½é‡æ²¹ç®±é…æ¯”ï¼ˆ60/20/20ï¼‰ã€‚</li>
                        <li><b>ä¸™åˆç«å¹´å±æ©Ÿæ‡‰å°æŒ‡ä»¤</b>ï¼šå¦‚ä½•åœ¨å¤§ç«ç’°å¢ƒä¸­å®ˆä½åº•æ°£ã€‚</li>
                    </ul>
                    <div class="æŠ˜æŠµæ–¹æ¡ˆ">âœ¦ é›²æ¼¾ä¸»ç†äººé™æ™‚æ‰¿è«¾ âœ¦<br>è§£é–æœ¬å ±å‘Šä¹‹è²»ç”¨å¯æ–¼å¾ŒçºŒé ç´„ç·šä¸‹è«®è©¢<br>æˆ–å®šåˆ¶é«˜ç«¯æ°´æ™¶æ™‚ã€å…¨é¡æŠ˜æŠµã€‘ã€‚</div>
                    <a href="https://p.ecpay.com.tw/28F4276" target="_blank" class="åº•éƒ¨æŒ‰éˆ• å¼·èª¿">ç«‹å³è§£é–å®Œæ•´å¹´åº¦æˆ°ç•¥è§£æ</a>
                </div>
            </div>
            <div style="margin-top:20px; display:grid; gap:12px;">
                <button onclick="location.reload()" class="åº•éƒ¨æŒ‰éˆ•">âœ¦ é‡æ–°è§£ç¢¼æ–°æ•¸æ“š</button>
                <a href="https://lin.ee/Nsksu05" target="_blank" class="åº•éƒ¨æŒ‰éˆ• å¼·èª¿">ğŸ’¬ è¯ç¹«é›²æ¼¾è«®è©¢ / é ç´„å®šåˆ¶å°æ¥</a>
            </div>
        `;
        document.getElementById('å ±å‘Šå€åŸŸ').innerHTML = html;
        document.getElementById('å ±å‘Šå€åŸŸ').style.display = 'block';
        document.getElementById('inputSection').style.display = 'none';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>
</body>
</html>